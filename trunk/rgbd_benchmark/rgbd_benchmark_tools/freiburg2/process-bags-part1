#!/bin/bash
#set -o verbose #echo onset +o verbose #echo off
#p=$(rospack find kinect_datasets)/bags

# generate calibration data
#echo $p
#scripts/add_points.py $p/public/kinect_dataset_rgb_calibration.bag --nth 15
#scripts/add_groundtruth.py --prop Kinect.prop --prop CheckerBoard.prop $p/public/kinect_dataset_rgb_calibration-points.bag
#exit

# now add points and tf data to all files
#echo "#!/bin/bash"
#for fi in $(find $p -name "*.bag" | grep -v points.bag | grep -v gt.bag ); do
#  echo "./process-file $fi \$1 2>&1 | tee process-$(basename $fi).log"
#  ./process-file $fi 2>&1 | tee process-$(basename $fi).log &
#done

datasets="xyz rpy desk coke desk_with_person teddy"
cd $(rospack find rgbd_benchmark_tools)

for dataset in $datasets; do
  ln -s /work/sturmju/freiburg2/bags-freiburg2/kinect_dataset_$dataset.bag /tmp/rgbd_dataset_freiburg2_$dataset.bag
  ln -s /work/sturmju/freiburg2/bags-freiburg2/kinect_dataset_$dataset-info.txt /tmp/rgbd_dataset_freiburg2_$dataset-info.txt
  freiburg2/process-file /tmp/rgbd_dataset_freiburg2_$dataset.bag /work/sturmju/tmp/freiburg2
done 

ln -s /work/sturmju/freiburg2/bags-freiburg2/kinect_dataset_ir_calibration.bag /tmp/rgbd_dataset_freiburg2_ir_calibration.bag
ln -s /work/sturmju/freiburg2/bags-freiburg2/kinect_dataset_ir_calibration-info.txt /tmp/rgbd_dataset_freiburg2_ir_calibration-info.txt
freiburg2/process-file-ir /tmp/rgbd_dataset_freiburg2_ir_calibration.bag /work/sturmju/tmp/freiburg2
