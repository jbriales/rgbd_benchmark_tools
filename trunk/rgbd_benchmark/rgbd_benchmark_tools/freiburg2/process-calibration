#!/bin/bash

cd $(rospack find rgbd_benchmark_tools)

ORIGINAL_BAG=/work/sturmju/freiburg2/bags-freiburg2/kinect_dataset_rgb_calibration.bag
SYNCED_BAG=/work/sturmju/tmp/freiburg2_calibration-synced.bag
CALIBRATION_BAG=freiburg2/calibration.bag
PROP="--prop freiburg2/kinect.prop --prop  freiburg2/checkerboard.prop" 
LOGFILE=freiburg2/delay.txt

date >> $LOGFILE
echo "delay[s] error[m]" >> $LOGFILE
for DELAY in -0.10 -0.09 -0.08 -0.07 -0.06 -0.05 -0.04 -0.03 -0.02 -0.01 0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 0.1; do
	scripts/synchronize.py --delay $DELAY $ORIGINAL_BAG $SYNCED_BAG
	ERR=$(scripts/calibrate2.py $SYNCED_BAG $CALIBRATION_BAG $PROP | tail -n 1)
	echo $DELAY $ERR >> $LOGFILE
	echo $DELAY $ERR
done

 
